---
import { actions } from "astro:actions";

const categories = await Astro.callAction(
  actions.getCategoryWithProductCount,
  {}
);

const { slug } = Astro.params;
---

<aside
  class="p-6 w-full md:w-1/5 md:min-h-[calc(100dvh-15.56rem)] md:border-r-2"
>
  <h2 class="text-lg font-semibold border-b pb-2 border-white/10">
    Product Categories
  </h2>

  <ul class="space-y-3">
    {
      categories?.data?.map((cat) => (
        <li class="flex justify-between text-sm hover:text-gray-500 transition">
          <a href={`/categories/${cat.slug}`} data-astro-prefetch>
            <span
              class={`dark:text-white text-gray-900 hover:font-bold ${
                slug === cat.slug ? "font-bold" : ""
              }`}
            >
              {cat.categoryName}
            </span>
            <span class="text-gray-500 dark:text-white">
              ({cat.productCount})
            </span>
          </a>
        </li>
      ))
    }
  </ul>
</aside>
