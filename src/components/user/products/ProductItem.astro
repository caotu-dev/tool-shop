---
import { Card, CardContent } from "@/components/ui/card";
import ProductImage from './ProductImage.astro';
import { getProductImage } from "@/lib/utils";
import { currencyFormat } from "@/lib/utils";

const { item } = Astro.props;
---

<a
  href={`/products/${item.slug}`}
  class="group block hover:shadow-lg transition-shadow rounded-xl overflow-hidden"
  data-astro-prefetch
>
  <Card className="p-0 border border-border bg-card rounded-xl">
    <CardContent className="p-0">
      <!-- Product Image -->
      <div class="relative">
        <ProductImage
          class="h-64 w-full object-cover group-hover:scale-105 transition-transform duration-300"
          src={getProductImage(item.thumbnail)[0]}
          alt={item.name}
        />

        {item.stock === 0 && (
          <span class="absolute top-3 left-3 bg-destructive text-white text-xs font-semibold px-2 py-1 rounded-md shadow">
            Out of Stock
          </span>
        )}
      </div>

      <!-- Product Info -->
      <div class="p-3 text-center space-y-1">
        <p class="font-heading font-semibold text-lg text-foreground group-hover:text-primary transition">
          {item.name}
        </p>
        <p class="text-sm text-muted-foreground line-clamp-2">
          {item.description || ""}
        </p>
        <p class="text-xl font-bold text-primary">
          {currencyFormat(item.price)}
        </p>
      </div>
    </CardContent>
  </Card>
</a>
